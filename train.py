#!/usr/bin/env python3
# Generated by MLC Compiler
# Auto-generated machine learning training script

# Multiple models - tracking for comparison
import pandas as pd
from sklearn.model_selection import train_test_split
import joblib

model_results = []

# =====================================
# Model 1: GradientBoostingClassifier
# Backend: sklearn
# Parameters: n_estimators=100, learning_rate=0.100000, max_depth=3, random_state=42
# =====================================

# Imports
import pandas as pd
from sklearn.model_selection import train_test_split
import joblib

# Load dataset
dataset = pd.read_csv('./data.csv')
X = dataset.iloc[:, :-1].values
y = dataset.iloc[:, -1].values

# Split dataset
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Model: GradientBoostingClassifier
# Custom model - using dynamic import
# Trying to import: GradientBoostingClassifier
import importlib
from sklearn.metrics import accuracy_score, classification_report, mean_squared_error, r2_score

# Try to find and import the model
model_class = None
sklearn_modules = [
    'sklearn.ensemble',
    'sklearn.linear_model',
    'sklearn.tree',
    'sklearn.svm',
    'sklearn.neighbors',
    'sklearn.naive_bayes',
    'sklearn.cluster',
    'sklearn.neural_network',
    'sklearn.discriminant_analysis',
]

for module_name in sklearn_modules:
    try:
        module = importlib.import_module(module_name)
        if hasattr(module, 'GradientBoostingClassifier'):
            model_class = getattr(module, 'GradientBoostingClassifier')
            print(f'âœ“ Found {model_class.__name__} in {module_name}')
            break
    except:
        continue

if model_class is None:
    raise ImportError(f'Could not find model: GradientBoostingClassifier in scikit-learn')

# Create model instance with parameters
model = model_class(n_estimators=100, learning_rate=0.100000, max_depth=3, random_state=42)

print('ğŸš€ Starting training...')
model.fit(X_train, y_train)
print('âœ… Training completed!')

# Make predictions
y_pred = model.predict(X_test)

# Try to determine if it's a classifier or regressor
is_classifier = hasattr(model, 'predict_proba') or 'Classifier' in model_class.__name__

if is_classifier:
    accuracy = accuracy_score(y_test, y_pred)
    print(f'ğŸ“Š Accuracy: {accuracy:.4f}')
    print('\nğŸ“‹ Classification Report:')
    print(classification_report(y_test, y_pred))
    model_results.append({'name': 'GradientBoostingClassifier', 'accuracy': accuracy, 'type': 'classifier'})
else:
    mse = mean_squared_error(y_test, y_pred)
    r2 = r2_score(y_test, y_pred)
    print(f'ğŸ“Š Mean Squared Error: {mse:.4f}')
    print(f'ğŸ“Š RÂ² Score: {r2:.4f}')
    model_results.append({'name': 'GradientBoostingClassifier', 'r2': r2, 'mse': mse, 'type': 'regressor'})

# Save model
model_filename = 'model_GradientBoostingClassifier.pkl'
joblib.dump(model, model_filename)
print(f'ğŸ’¾ Model saved as {model_filename}')
# =====================================
# Model 2: AdaBoostClassifier
# Backend: sklearn
# Parameters: n_estimators=50, learning_rate=1.000000, random_state=42
# =====================================

# Imports
import pandas as pd
from sklearn.model_selection import train_test_split
import joblib

# Load dataset
dataset = pd.read_csv('./data.csv')
X = dataset.iloc[:, :-1].values
y = dataset.iloc[:, -1].values

# Split dataset
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Model: AdaBoostClassifier
# Custom model - using dynamic import
# Trying to import: AdaBoostClassifier
import importlib
from sklearn.metrics import accuracy_score, classification_report, mean_squared_error, r2_score

# Try to find and import the model
model_class = None
sklearn_modules = [
    'sklearn.ensemble',
    'sklearn.linear_model',
    'sklearn.tree',
    'sklearn.svm',
    'sklearn.neighbors',
    'sklearn.naive_bayes',
    'sklearn.cluster',
    'sklearn.neural_network',
    'sklearn.discriminant_analysis',
]

for module_name in sklearn_modules:
    try:
        module = importlib.import_module(module_name)
        if hasattr(module, 'AdaBoostClassifier'):
            model_class = getattr(module, 'AdaBoostClassifier')
            print(f'âœ“ Found {model_class.__name__} in {module_name}')
            break
    except:
        continue

if model_class is None:
    raise ImportError(f'Could not find model: AdaBoostClassifier in scikit-learn')

# Create model instance with parameters
model = model_class(n_estimators=50, learning_rate=1.000000, random_state=42)

print('ğŸš€ Starting training...')
model.fit(X_train, y_train)
print('âœ… Training completed!')

# Make predictions
y_pred = model.predict(X_test)

# Try to determine if it's a classifier or regressor
is_classifier = hasattr(model, 'predict_proba') or 'Classifier' in model_class.__name__

if is_classifier:
    accuracy = accuracy_score(y_test, y_pred)
    print(f'ğŸ“Š Accuracy: {accuracy:.4f}')
    print('\nğŸ“‹ Classification Report:')
    print(classification_report(y_test, y_pred))
    model_results.append({'name': 'AdaBoostClassifier', 'accuracy': accuracy, 'type': 'classifier'})
else:
    mse = mean_squared_error(y_test, y_pred)
    r2 = r2_score(y_test, y_pred)
    print(f'ğŸ“Š Mean Squared Error: {mse:.4f}')
    print(f'ğŸ“Š RÂ² Score: {r2:.4f}')
    model_results.append({'name': 'AdaBoostClassifier', 'r2': r2, 'mse': mse, 'type': 'regressor'})

# Save model
model_filename = 'model_AdaBoostClassifier.pkl'
joblib.dump(model, model_filename)
print(f'ğŸ’¾ Model saved as {model_filename}')
# =====================================
# Model 3: MLPClassifier
# Backend: sklearn
# Parameters: hidden_layer_sizes=100, activation=relu, solver=adam, max_iter=500, random_state=42
# =====================================

# Imports
import pandas as pd
from sklearn.model_selection import train_test_split
import joblib

# Load dataset
dataset = pd.read_csv('./data.csv')
X = dataset.iloc[:, :-1].values
y = dataset.iloc[:, -1].values

# Split dataset
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Model: MLPClassifier
# Custom model - using dynamic import
# Trying to import: MLPClassifier
import importlib
from sklearn.metrics import accuracy_score, classification_report, mean_squared_error, r2_score

# Try to find and import the model
model_class = None
sklearn_modules = [
    'sklearn.ensemble',
    'sklearn.linear_model',
    'sklearn.tree',
    'sklearn.svm',
    'sklearn.neighbors',
    'sklearn.naive_bayes',
    'sklearn.cluster',
    'sklearn.neural_network',
    'sklearn.discriminant_analysis',
]

for module_name in sklearn_modules:
    try:
        module = importlib.import_module(module_name)
        if hasattr(module, 'MLPClassifier'):
            model_class = getattr(module, 'MLPClassifier')
            print(f'âœ“ Found {model_class.__name__} in {module_name}')
            break
    except:
        continue

if model_class is None:
    raise ImportError(f'Could not find model: MLPClassifier in scikit-learn')

# Create model instance with parameters
model = model_class(hidden_layer_sizes=100, activation='relu', solver='adam', max_iter=500, random_state=42)

print('ğŸš€ Starting training...')
model.fit(X_train, y_train)
print('âœ… Training completed!')

# Make predictions
y_pred = model.predict(X_test)

# Try to determine if it's a classifier or regressor
is_classifier = hasattr(model, 'predict_proba') or 'Classifier' in model_class.__name__

if is_classifier:
    accuracy = accuracy_score(y_test, y_pred)
    print(f'ğŸ“Š Accuracy: {accuracy:.4f}')
    print('\nğŸ“‹ Classification Report:')
    print(classification_report(y_test, y_pred))
    model_results.append({'name': 'MLPClassifier', 'accuracy': accuracy, 'type': 'classifier'})
else:
    mse = mean_squared_error(y_test, y_pred)
    r2 = r2_score(y_test, y_pred)
    print(f'ğŸ“Š Mean Squared Error: {mse:.4f}')
    print(f'ğŸ“Š RÂ² Score: {r2:.4f}')
    model_results.append({'name': 'MLPClassifier', 'r2': r2, 'mse': mse, 'type': 'regressor'})

# Save model
model_filename = 'model_MLPClassifier.pkl'
joblib.dump(model, model_filename)
print(f'ğŸ’¾ Model saved as {model_filename}')

# =====================================
# MODEL COMPARISON
# =====================================

print('\n' + '='*60)
print('ğŸ“Š MODEL COMPARISON RESULTS')
print('='*60 + '\n')

# Display all models
for i, result in enumerate(model_results, 1):
    print(f"{i}. {result['name']}:")
    if result['type'] == 'classifier':
        print(f"   Accuracy: {result['accuracy']:.4f} ({result['accuracy']*100:.2f}%)")
    else:
        print(f"   RÂ² Score: {result['r2']:.4f}")
        print(f"   MSE: {result['mse']:.4f}")
    print()

# Find best model
classifiers = [r for r in model_results if r['type'] == 'classifier']
regressors = [r for r in model_results if r['type'] == 'regressor']

best_model = None
if classifiers:
    best_model = max(classifiers, key=lambda x: x['accuracy'])
    print(f"ğŸ† BEST CLASSIFIER: {best_model['name']}")
    print(f"   Accuracy: {best_model['accuracy']:.4f} ({best_model['accuracy']*100:.2f}%)\n")
elif regressors:
    best_model = max(regressors, key=lambda x: x['r2'])
    print(f"ğŸ† BEST REGRESSOR: {best_model['name']}")
    print(f"   RÂ² Score: {best_model['r2']:.4f}\n")

# Copy best model to model.pkl for easy prediction
if best_model:
    import shutil
    best_model_file = f"model_{best_model['name']}.pkl"
    shutil.copy(best_model_file, 'model.pkl')
    print(f"âœ… Best model copied to model.pkl for prediction\n")
    print(f"ğŸ“ All models saved:")
    for result in model_results:
        print(f"   - model_{result['name']}.pkl")
    print(f"   - model.pkl (best model)\n")
